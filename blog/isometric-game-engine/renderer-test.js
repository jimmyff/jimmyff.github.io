var j=void 0,m=null,o,p=this;function q(a,b,c){a=a.split(".");c=c||p;!(a[0]in c)&&c.execScript&&c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)!a.length&&b!==j?c[d]=b:c=c[d]?c[d]:c[d]={}}
function r(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b}var s="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),u=0;function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}else return function(){return a.apply(b,arguments)}}
function v(a,b,c){v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?aa:ba;return v.apply(m,arguments)}function w(a,b){function c(){}c.prototype=b.prototype;a.ka=b.prototype;a.prototype=new c};function x(a){this.b=a.b;this.b.e("LOG","CanvasSimple renderer ready")}
x.prototype={s:function(a,b,c){c.clear&&this.M(a,b);this.O(a,b,c,c.width,c.height,c.m,c.n);this.N(a,b,c,c.width,c.height,c.m,c.n)},q:function(a,b,c,d,g){var e=d/2,f=g/2,d=d-1-a,g=g-1-b;switch(c){case "NORTH":c=e+a-(b-f);a=f+(b/2+(a-e)/2);break;case "EAST":c=e+d-(b-f);a=f+(g/2+(a-e)/2);break;case "SOUTH":c=e+d-(g-f);a=f+(g/2+(d-e)/2);break;case "WEST":c=e+a-(g-f);a=f+(b/2+(d-e)/2);break;default:c=a,a=b}return{x:c,y:a}},O:function(a,b,c,d,g,e,f){a.a.fillStyle="rgb(180,180,180)";a.a.strokeStyle="rgb(80,80,80)";
a.a.textAlign="center";b=d/a.c/2;a.a.lineWidth=b/20;for(var h=0;h<=a.c;h++){var i=this.q(h-0.5,-0.5,c.direction,a.c,a.f,d,g),k=this.q(h-0.5,a.c-0.5,c.direction,a.c,a.f,d,g);a.a.beginPath();a.a.moveTo(e+i.x*b,f+i.y*b);a.a.lineTo(e+k.x*b,f+k.y*b);a.a.closePath();a.a.stroke()}for(var l=0;l<=a.f;l++)i=this.q(-0.5,l-0.5,c.direction,a.c,a.f,d,g),k=this.q(a.f-0.5,l-0.5,c.direction,a.c,a.f,d,g),a.a.beginPath(),a.a.moveTo(e+i.x*b,f+i.y*b),a.a.lineTo(e+k.x*b,f+k.y*b),a.a.closePath(),a.a.stroke();if(b>15){a.a.font=
Math.round(b/3)+"pt Arial";for(h=0;h<a.c;h++)for(l=0;l<a.f;l++)i=this.q(h,l,c.direction,a.c,a.f,d,g),a.a.fillText(h+"x"+l,e+i.x*b,f+i.y*b)}},M:function(a){a.a.fillStyle="rgb(230,230,230)";a.a.fillRect(0,0,a.H,a.G);a.a.restore()},N:function(a,b,c,d,g,e,f){b=d/a.c/2;a.a.lineWidth=b/2;for(var h=0;h<a.g.length;h++){a.a.strokeStyle=a.g[h].Q;var i=this.q(a.g[h].coords.x,a.g[h].coords.y,c.direction,a.c,a.f,d,g);a.a.beginPath();a.a.moveTo(e+i.x*b,f+i.y*b);a.a.lineTo(e+i.x*b,f+i.y*b-b*1.1);a.a.closePath();
a.a.stroke()}}};function ca(a,b,c){this.coords={x:a,y:b};this.d={x:a,y:b};this.Q=c}
ca.prototype={t:function(a){a=a.da/500;if(this.coords.x==this.d.x&&this.coords.y==this.d.y)switch(Math.round(Math.random()*1)){case 0:this.d.x=Math.round(Math.random()*9);break;case 1:this.d.y=Math.round(Math.random()*9)}this.d.x>this.coords.x?this.coords.x+=a:this.d.x<this.coords.x?this.coords.x-=a:this.d.y>this.coords.y?this.coords.y+=a:this.d.y<this.coords.y&&(this.coords.y-=a);if(this.coords.x-this.d.x<a&&this.coords.x-this.d.x>-a)this.coords.x=this.d.x;if(this.coords.y-this.d.y<a&&this.coords.y-
this.d.y>-a)this.coords.y=this.d.y}};function y(a,b){if(a<b)return-1;else if(a>b)return 1;return 0};var z=Array.prototype,da=z.indexOf?function(a,b,c){return z.indexOf.call(a,b,c)}:function(a,b,c){c=c==m?0:c<0?Math.max(0,a.length+c):c;if(typeof a=="string")return typeof b!="string"||b.length!=1?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},ea=z.forEach?function(a,b,c){z.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,g=typeof a=="string"?a.split(""):a,e=0;e<d;e++)e in g&&b.call(c,g[e],e,a)};function fa(){this.u={}}fa.prototype={U:function(a){this.u||(this.u={});this.u[a]||(this.u[a]=[]);return this.u[a]},K:function(a,b,c){this.e("LOG","Events: Listener Attached: "+a);a=this.U(a);c&&(b=v(b,c));a.push(b)},e:function(a,b){a!=="LOG"&&a!=="TICK"&&a!=="CURSOR:MOVE"&&this.e("LOG","Events: Fired: "+a,b);ea(this.U(a),function(a){a.apply(m,!b?[]:typeof b=="array"?b:[b])})}};var A,B,C,D;function ga(){return p.navigator?p.navigator.userAgent:m}D=C=B=A=!1;var E;if(E=ga()){var ha=p.navigator;A=E.indexOf("Opera")==0;B=!A&&E.indexOf("MSIE")!=-1;C=!A&&E.indexOf("WebKit")!=-1;D=!A&&!C&&ha.product=="Gecko"}var ia=A,F=B,G=D,H=C,ja=p.navigator,ka=(ja&&ja.platform||"").indexOf("Mac")!=-1,I;
a:{var J="",K;if(ia&&p.opera)var L=p.opera.version,J=typeof L=="function"?L():L;else if(G?K=/rv\:([^\);]+)(\)|;)/:F?K=/MSIE\s+([^\);]+)(\)|;)/:H&&(K=/WebKit\/(\S+)/),K)var la=K.exec(ga()),J=la?la[1]:"";if(F){var M,ma=p.document;M=ma?ma.documentMode:j;if(M>parseFloat(J)){I=String(M);break a}}I=J}var na={};
function O(a){var b;if(!(b=na[a])){b=0;for(var c=String(I).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),g=Math.max(c.length,d.length),e=0;b==0&&e<g;e++){var f=c[e]||"",h=d[e]||"",i=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var l=i.exec(f)||["","",""],n=k.exec(h)||["","",""];if(l[0].length==0&&n[0].length==0)break;b=y(l[1].length==0?0:parseInt(l[1],10),n[1].length==0?0:parseInt(n[1],10))||y(l[2].length==0,n[2].length==
0)||y(l[2],n[2])}while(b==0)}b=na[a]=b>=0}return b}var oa={};function P(){return oa[9]||(oa[9]=F&&!!document.documentMode&&document.documentMode>=9)};function pa(){}var qa=0;o=pa.prototype;o.key=0;o.r=!1;o.P=!1;o.i=function(a,b,c,d,g,e){if(r(a)=="function")this.W=!0;else if(a&&a.handleEvent&&r(a.handleEvent)=="function")this.W=!1;else throw Error("Invalid listener argument");this.B=a;this.Y=b;this.src=c;this.type=d;this.capture=!!g;this.V=e;this.P=!1;this.key=++qa;this.r=!1};o.handleEvent=function(a){return this.W?this.B.call(this.V||this.src,a):this.B.handleEvent.call(this.B,a)};!F||P();var ra=!F||P();F&&O("8");!H||O("528");G&&O("1.9b")||F&&O("8")||ia&&O("9.5")||H&&O("528");!G||O("8");function Q(){}Q.prototype.R=!1;Q.prototype.z=function(){if(!this.R)this.R=!0,this.A()};Q.prototype.A=function(){this.ca&&sa.apply(m,this.ca)};function sa(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b],g=r(d);g=="array"||g=="object"&&typeof d.length=="number"?sa.apply(m,d):d&&typeof d.z=="function"&&d.z()}};function R(a,b){this.type=a;this.currentTarget=this.target=b}w(R,Q);R.prototype.A=function(){delete this.type;delete this.target;delete this.currentTarget};R.prototype.L=!1;R.prototype.ja=!0;function S(a){S[" "](a);return a}S[" "]=function(){};function T(a,b){a&&this.i(a,b)}w(T,R);o=T.prototype;o.target=m;o.relatedTarget=m;o.offsetX=0;o.offsetY=0;o.clientX=0;o.clientY=0;o.screenX=0;o.screenY=0;o.button=0;o.keyCode=0;o.charCode=0;o.ctrlKey=!1;o.altKey=!1;o.shiftKey=!1;o.metaKey=!1;o.ia=!1;o.S=m;
o.i=function(a,b){var c=this.type=a.type;R.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(G){var g;a:{try{S(d.nodeName);g=!0;break a}catch(e){}g=!1}g||(d=m)}}else if(c=="mouseover")d=a.fromElement;else if(c=="mouseout")d=a.toElement;this.relatedTarget=d;this.offsetX=H||a.offsetX!==j?a.offsetX:a.layerX;this.offsetY=H||a.offsetY!==j?a.offsetY:a.layerY;this.clientX=a.clientX!==j?a.clientX:a.pageX;this.clientY=a.clientY!==j?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(c=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.ia=ka?a.metaKey:a.ctrlKey;this.state=a.state;this.S=a;delete this.ja;delete this.L};o.A=function(){T.ka.A.call(this);this.relatedTarget=this.currentTarget=this.target=this.S=m};var U={},V={},W={},X={};
function Y(a,b,c,d,g){if(b)if(r(b)=="array")for(var e=0;e<b.length;e++)Y(a,b[e],c,d,g);else{var d=!!d,f=V;b in f||(f[b]={j:0,o:0});f=f[b];d in f||(f[d]={j:0,o:0},f.j++);var f=f[d],h=a[s]||(a[s]=++u),i;f.o++;if(f[h]){i=f[h];for(e=0;e<i.length;e++)if(f=i[e],f.B==c&&f.V==g){if(f.r)break;return}}else i=f[h]=[],f.j++;e=ta();e.src=a;f=new pa;f.i(c,e,a,b,d,g);c=f.key;e.key=c;i.push(f);U[c]=f;W[h]||(W[h]=[]);W[h].push(f);a.addEventListener?(a==p||!a.ba)&&a.addEventListener(b,e,d):a.attachEvent(b in X?X[b]:
X[b]="on"+b,e)}else throw Error("Invalid event type");}function ta(){var a=ua,b=ra?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function va(a,b,c,d){if(!d.C&&d.X){for(var g=0,e=0;g<d.length;g++)d[g].r?d[g].Y.src=m:(g!=e&&(d[e]=d[g]),e++);d.length=e;d.X=!1;e==0&&(delete V[a][b][c],V[a][b].j--,V[a][b].j==0&&(delete V[a][b],V[a].j--),V[a].j==0&&delete V[a])}}
function wa(a,b,c,d,g){var e=1,b=b[s]||(b[s]=++u);if(a[b]){a.o--;a=a[b];a.C?a.C++:a.C=1;try{for(var f=a.length,h=0;h<f;h++){var i=a[h];i&&!i.r&&(e&=Z(i,g)!==!1)}}finally{a.C--,va(c,d,b,a)}}return Boolean(e)}
function Z(a,b){var c=a.handleEvent(b);if(a.P){var d=a.key;if(U[d]){var g=U[d];if(!g.r){var e=g.src,f=g.type,h=g.Y,i=g.capture;e.removeEventListener?(e==p||!e.ba)&&e.removeEventListener(f,h,i):e.detachEvent&&e.detachEvent(f in X?X[f]:X[f]="on"+f,h);e=e[s]||(e[s]=++u);h=V[f][i][e];if(W[e]){var k=W[e],l=da(k,g);l>=0&&z.splice.call(k,l,1);k.length==0&&delete W[e]}g.r=!0;h.X=!0;va(f,i,e,h);delete U[d]}}}return c}
function ua(a,b){if(!U[a])return!0;var c=U[a],d=c.type,g=V;if(!(d in g))return!0;var g=g[d],e,f;if(!ra){var h;if(!(h=b))a:{h="window.event".split(".");for(var i=p;e=h.shift();)if(i[e]!=m)i=i[e];else{h=m;break a}h=i}e=h;h=!0 in g;i=!1 in g;if(h){if(e.keyCode<0||e.returnValue!=j)return!0;a:{var k=!1;if(e.keyCode==0)try{e.keyCode=-1;break a}catch(l){k=!0}if(k||e.returnValue==j)e.returnValue=!0}}k=new T;k.i(e,this);e=!0;try{if(h){for(var n=[],N=k.currentTarget;N;N=N.parentNode)n.push(N);f=g[!0];f.o=f.j;
for(var t=n.length-1;!k.L&&t>=0&&f.o;t--)k.currentTarget=n[t],e&=wa(f,n[t],d,!0,k);if(i){f=g[!1];f.o=f.j;for(t=0;!k.L&&t<n.length&&f.o;t++)k.currentTarget=n[t],e&=wa(f,n[t],d,!1,k)}}else e=Z(c,k)}finally{if(n)n.length=0;k.z()}return e}d=new T(b,this);try{e=Z(c,d)}finally{d.z()}return e};function xa(a,b){this.x=a;this.y=b}xa.prototype={length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},toString:function(){return" X: "+this.x+" Y: "+this.y}};function ya(a){this.position=j;this.b=a.b}ya.prototype={i:function(){typeof console!=="undefined"&&console.log("Mouse Initalised")},aa:function(a){var b=this;Y(a,"mousemove",function(c){var d=c.offsetX-a.offsetLeft;d<0?(d=c.offsetX,c=c.offsetY):c=c.offsetY-a.offsetTop;b.position=new xa(d,c)});Y(a,"click",function(){b.b.e("MOUSE:CLICK",a)});Y(a,"mousedown",function(){b.b.e("MOUSE:DOWN",a)});Y(a,"mouseup",function(){b.b.e("MOUSE:UP",a)});Y(a,"mouseout",function(){b.b.e("MOUSE:OUT",a)});console.log("attached to element")}};function za(a){this.b=a.b;this.b.e("LOG","CanvasSimple renderer ready")}
za.prototype={s:function(a,b,c){c.clear&&this.M(a,b);this.O(a,b,c.width,c.height,c.m,c.n);this.N(a,b,c.width,c.height,c.m,c.n)},O:function(a,b,c,d,g,e){a.a.fillStyle="rgb(180,180,180)";a.a.strokeStyle="rgb(80,80,80)";a.a.textAlign="center";b=c/a.c;a.a.lineWidth=b/20;a.a.font=Math.round(b/3)+"pt Arial";for(var f=0;f<=a.c;f++)a.a.beginPath(),a.a.moveTo(g,e+f*b),a.a.lineTo(g+c,e+f*b),a.a.closePath(),a.a.stroke();for(c=0;c<=a.f;c++)a.a.beginPath(),a.a.moveTo(g+c*b,e),a.a.lineTo(g+c*b,e+d),a.a.closePath(),
a.a.stroke();for(f=0;f<a.c;f++)for(c=0;c<a.f;c++)a.a.fillText(f+"x"+c,g+f*b+b/2,e+c*b+b/2)},N:function(a,b,c,d,g,e){b=c/a.c;c=b/3;for(d=0;d<a.g.length;d++)a.a.fillStyle=a.g[d].Q,a.a.beginPath(),a.a.arc(g+a.g[d].coords.x*b+b/2,e+a.g[d].coords.y*b+b/2,c,0,Math.PI*2,!0),a.a.fill(),a.a.closePath()},M:function(a){a.a.fillStyle="rgb(230,230,230)";a.a.fillRect(0,0,a.H,a.G);a.a.restore()}};function Aa(a){this.enabled=a&&a.enabled?a.enabled:!0;this.b=a&&a.b?a.b:j;this.i()}Aa.prototype={i:function(){this.b&&(this.log("Listening..."),this.b.K("LOG",this.log,this))},log:function(a,b){this.enabled&&typeof console!=="undefined"&&(console.log("Logger: "+a),b&&console.log(b))}};!F||P();!G&&!F||F&&P()||G&&O("1.9.1");F&&O("9");function Ba(){var a=document;if(a.querySelectorAll&&a.querySelector&&(!H||document.compatMode=="CSS1Compat"||O("528")))return a.querySelectorAll(".fps");else if(a.getElementsByClassName)return a.getElementsByClassName("fps");return Ca()}
function Ca(){var a,b,c,d;a=document;if(a.querySelectorAll&&a.querySelector&&(!H||document.compatMode=="CSS1Compat"||O("528")))return a.querySelectorAll(".fps");if(a.getElementsByClassName){var g=a.getElementsByClassName("fps");return g}g=a.getElementsByTagName("*");d={};for(b=c=0;a=g[b];b++){var e=a.className;typeof e.split=="function"&&da(e.split(/\s+/),"fps")>=0&&(d[c++]=a)}d.length=c;return d};function Da(a){this.b=a.b;this.F=this.w=m;this.p=[];this.J=j;this.D=a&&a.D?a.D:1;this.k=a&&a.k?a.k:30;this.la=j;this.I=0}
Da.prototype={i:function(a){this.la=a;this.b.e("LOG","Initalised Timer. FPS Cap: "+this.k+" speed: "+Math.round(this.D*100))},start:function(){this.t();setInterval(v(this.t,this),1E3/this.k)},t:function(){this.F=(new Date).getTime();if(!this.w)this.w=0;var a=this.F-this.w;a>0&&(a>1E3/this.k&&(a=1E3/this.k),this.I+=a/100);this.b.e("TICK",{da:a,T:this.J,I:this.I});this.T=1E3/(this.F-this.w);this.p.push(this.T);if(this.p.length>this.k){for(var b=a=0,c=this.p.length;b<c;b++)a+=this.p[b];this.J=Math.round(a/
this.p.length);this.p=[];var d=this;ea(Ba(),function(a){a.innerHTML=d.J})}this.w=this.F}};q("RendererTest",$,j);q("RendererTest.rotateCameraAngle",$.prototype.Z,$);function $(){this.b=new fa;this.ma=new Aa({b:this.b});this.H=900;this.G=450;this.$=new Da({b:this.b,D:1,k:20});this.ga=new ya({b:this.b});this.v={isometric:new x({b:this.b}),topDown:new za({b:this.b})};this.f=this.c=10;this.h=0;this.g=[];this.ha="rgb(20,20,180);rgb(20,180,20);rgb(180,20,20);rgb(20,180,180);rgb(180, 20,180);rgb(180,180,20)".split(";");this.i()}
$.prototype={i:function(){this.ea();this.fa();this.ga.aa(document.getElementById("canvasElement"));this.b.K("MOUSE:CLICK",this.Z,this);this.$.i();this.b.K("TICK",this.t,this);this.$.start();this.b.e("LOG","Initalised Game.")},ea:function(){var a=document.createElement("canvas");if(!a.getContext)throw this.b.e("LOG","Failed to create canvas element"),"Failed to create canvas element";this.a=a.getContext("2d");this.a.save();a.id="canvasElement";a.width=this.H;a.height=this.G;this.a.font="9pt Arial";
this.a.textAlign="center";this.a.textBaseline="middle";this.a.fillStyle="#222";document.getElementById("canvasContainer").appendChild(a);this.b.e("LOG","Initalised Canvas.")},fa:function(){for(var a=0;a<6;a++)this.g.push(new ca(Math.round(Math.random()*(this.c-1)),Math.round(Math.random()*(this.f-1)),this.ha[this.g.length]))},t:function(a){for(var b=0,c=this.g.length;b<c;b++)this.g[b].t(a);this.v.topDown.s(this,a,{clear:!0,width:300,height:300,m:50,n:75});this.v.isometric.s(this,a,{clear:!1,direction:this.l(this.h),
width:500,height:400,m:375,n:-20});this.v.isometric.s(this,a,{clear:!1,direction:this.l(this.h+1),width:160,height:150,m:375,n:295});this.v.isometric.s(this,a,{clear:!1,direction:this.l(this.h+2),width:160,height:150,m:545,n:295});this.v.isometric.s(this,a,{clear:!1,direction:this.l(this.h+3),width:160,height:150,m:713,n:295});this.a.font="9pt Arial";this.a.textAlign="left";this.a.fillStyle="rgb(80,80,80)";this.a.fillText("Isometric Camera: "+this.l(this.h),380,50);this.a.fillText("Isometric Camera: "+
this.l(this.h+1),390,420);this.a.fillText("Isometric Camera: "+this.l(this.h+2),560,420);this.a.fillText("Isometric Camera: "+this.l(this.h+3),730,420)},l:function(a){a>3&&(a-=4);switch(a){case 0:return"NORTH";case 1:return"EAST";case 2:return"SOUTH";case 3:return"WEST"}},Z:function(){this.h++;if(this.h>3)this.h=0}};
