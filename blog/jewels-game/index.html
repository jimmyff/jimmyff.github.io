<!doctype html><html prefix="og: https://ogp.me/ns#" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="Fun loving creative (he/him) üè≥Ô∏è‚Äçüåà" name=description><meta content="jimmy, forrester-fellowes, jimmyff, jimmy3ds, yorkshire, leeds, developer" name=keywords><title>
  HTML5 Jewels Switching Game // jimmyff // a creative & geeky personal blog</title><meta content="jimmyff | HTML5 Jewels Switching Game" property=og:title><meta content=website property=og:type><meta content=https://www.jimmyff.co.uk/blog/jewels-game/ property=og:url><meta content="Fun loving creative (he/him) üè≥Ô∏è‚Äçüåà" property=og:description><meta content="
    https://www.jimmyff.co.uk/processed_images/open_graph_image.8860f7e50aef5ee1.webp
    
" property=og:image><meta content=1200 property=og:image:width><meta content=630 property=og:image:height><link href=https://www.jimmyff.co.uk/atom.xml rel=alternate title=jimmyff type=application/rss+xml><link href=https://www.jimmyff.co.uk/base.css rel=stylesheet><body><header><div class=top><div class=avatar><a href=/> <img srcset="https://www.jimmyff.co.uk/processed_images/avatar_2024.9057fd955d2bd1d0.webp 64w, https://www.jimmyff.co.uk/processed_images/avatar_2024.b566c519a68e1b72.webp 128w, https://www.jimmyff.co.uk/processed_images/avatar_2024.73049685b9748c65.webp 256w" alt=jimmyff src=https://www.jimmyff.co.uk/processed_images/avatar_2024.b566c519a68e1b72.webp title=jimmyff> </a></div><div class=details><a class=site-name href=/> <h1>jimmyff</h1> </a><div class=site-description><p>Fun loving creative (he/him) üè≥Ô∏è‚Äçüåà</div></div><div class=right-button><a alt=Search href=https://www.jimmyff.co.uk/search/> üîé </a></div></div><nav><div class=links><a href="https://www.jimmyff.co.uk/blog/ " alt=Blog><span class=emoji>üìñ</span><span class=name>Blog</span></a><a href="https://www.jimmyff.co.uk/gallery/ " alt=Gallery><span class=emoji>üé®</span><span class=name>Gallery</span></a><a href="https://www.jimmyff.co.uk/projects/ " alt=Projects><span class=emoji>üí°</span><span class=name>Projects</span></a><a href="https://www.jimmyff.co.uk/games/ " alt=Games><span class=emoji>üé≤</span><span class=name>Games</span></a><details class="overflow-menu dropdown dropdown-right" alt=Menu><summary><div></div> <div></div> <div></div></summary> <ul><li><a href="https://www.jimmyff.co.uk/ " alt=Home><span class=emoji>üè†</span><span class=name>Home</span></a><li><a href="https://www.jimmyff.co.uk/guestbook/ " alt=Guestbook><span class=emoji>üåç</span><span class=name>Guestbook</span></a><li><a href="https://www.jimmyff.co.uk/apps/ " alt=Apps><span class=emoji>üì±</span><span class=name>Apps</span></a><li><a href="https://www.jimmyff.co.uk/inktober/ " alt=Inktober><span class=emoji>üé®</span><span class=name>Inktober</span></a><li><a alt="Contact me" href="https://docs.google.com/forms/d/e/1FAIpQLScIN2i8tudYfvWZO96Ed-_ma011PgZU-CrxRyCXdSA1z9NRjA/viewform "><span class=emoji>üìß</span><span class=name>Contact me</span></a></ul></details></div></nav></header><article><section class=post><div class=post-header><div class=meta><div class=date><span class=day>28</span><span class=rest>Mar 12</span></div></div><div class=matter><h1 class=title>HTML5 Jewels Switching Game</h1></div></div><article><script src=../../shared_assets/rocketbox/rocketbox_1_0.js></script><script src=CanvasJewels2.js></script><p>I'd bet that everyones been hooked on Bewjewled, ZooKeeper or another tile switching game at some point or another. Me and my partner whilst travelleing went through a phase trying to beat each others scores on the mobile variety of this genre which is what led me to the fun challenge of recreating this type of game in JavaScript.<h2 id=developing-the-game>Developing the game</h2><p>The project came together pretty quickly (a couple of sofa coding sessions), I was surpised at how tricky it was finding a decent way to store the grid and transision between which row the blocks are on. I tried a few different methods before finalising on a block array, a block object map and a grid object which stored a block reference for each of its coordinates.<p>There was a niggling issue I had with the frst version - not all the blocks were totally syncronised. The initial version was mostly callback driven, so if the user switched some blocks it would trigger the callbacks regadless of a where the game was in it's main loop. This resulted in blocks being slightly out of sync, maybe by only a millisecond or two but I wanted everything to fall perfectly in sync! After a bit of hacking I sorted this issue and it now keeps everything in sync by queuing jobs up and executing them syncronously at the correct time in the game loop.<div id=canvasJewels2_1></div><h2 id=layout-rendering>Layout & Rendering</h2><p>I took a slightly different approach to layout this time and I really like it. I consider the variable width & height to be 100 - as in 100%. As I know how many columns & rows I want I can calculate what position they're at, for example a block that is stationary in row 5, column 7, would<p>In the version below I've temporarily "borrowed" the ZooKeeper sprites to test using bitmap graphics. When I get round to finishing this I'll have original graphics!<div id=canvasJewels2_2></div><h2 id=finding-possible-switches>Finding possible switches</h2><p>When the current game runs out of possible switches it needs to know so it can act on it (usually the board resets if no more moves). In order to find the possible switches I broke down game logic in to 3 patterns which cover all possible switches. Every time the grid changes I recalculate the switches by testing every block against these 3 patterns horozontally & vertically.<h3 id=switch-pattern-1>Switch Pattern 1</h3><pre style=color:#c0c5ce;background-color:#2b303b><code><span> *  *  *  *       *  *  *  *
</span><span> A  B  _C   +   A_  B  C
</span><span> *  *  *  *       *  *  *  *
</span><span>
</span></code></pre><h3 id=switch-pattern-2>Switch Pattern 2</h3><pre style=color:#c0c5ce;background-color:#2b303b><code><span>* _C1_       _B1 C1_
</span><span> A  B  **+   A**  *  
</span><span>* _C2_       _B2 C2_  
</span><span>
</span></code></pre><h3 id=switch-pattern-3>Switch Pattern 3</h3><pre style=color:#c0c5ce;background-color:#2b303b><code><span>* B1 **
</span><span> A  _C_
</span><span>* B2 **
</span></code></pre><p>The demo below highlights the possible switches by rendering a line connecting the blocks. It will randomly switch blocks, to stop it from running out of switches I'm also randomly removing blocks & rows. (If you notice that sometimes the switches fail it's because it's not considering if the blocks haven't finished falling in to position, if they are this will result in a switch fail!).<div id=canvasJewels2_3></div><h2 id=the-jewels-game-to-do-list>The jewels game to-do list</h2><p>The game mechanics are all mostly there now. The next things I'll add to this will be:<ul><li><input disabled type=checkbox> Scores & Combos<li><input disabled type=checkbox> Level based difficulty system. Each level score target & time to reach that score<li><input disabled type=checkbox> Original graphics! (any designers out there?!)<li><input disabled type=checkbox> Leaderboards<li><input disabled type=checkbox> Fun stuff! I'm sure I'll come up with some fun new features I can add that will make my jewel switching game a little different!</ul><p>Stay tuned for a future updates!</p><script>var canvasJewels2_1=new RocketBox(new CanvasJewels({renderer:`simple`,imagePath:`./`}),{id:`canvasJewels2_1`,width:500,height:500,title:`Jewels Game : Simple Renderer`,description:`Click on a block and drag to an adjacent block to switch them. Get 3 in a row to make them disappear!`,canvasResize:!0});var canvasJewels2_2=new RocketBox(new CanvasJewels({renderer:`production`,imagePath:`./`}),{id:`canvasJewels2_2`,width:500,height:500,title:`Jewels Game : Graphical Renderer`,description:`I've ahem, temporarily borrowed the ZooKeeper sprites to test rendering bitmap graphics instead of geometric shapes.`,canvasResize:!0});var canvasJewels2_3=new RocketBox(new CanvasJewels({renderer:`simple`,imagePath:`./`,autoSwitch:!0,destoryRows:!0,destoryBlocks:!0,showSwitches:!0}),{id:`canvasJewels2_3`,width:500,height:500,title:`AI Playing the Jewels Game`,description:`Sit back and watch the AI play the game, you can join in too if you like!`,canvasResize:!0})</script></article><ul class=tags><li><a href=https://www.jimmyff.co.uk/tags/coding>coding</a><li><a href=https://www.jimmyff.co.uk/tags/gamedev-digital>gamedev-digital</a><li><a href=https://www.jimmyff.co.uk/tags/lang-javascript>lang-javascript</a></ul></section></article><footer><div class=social><ul><li><a href=https://github.com/jimmyff rel=me title=Github><i data-feather=github></i></a><li><a href=https://www.youtube.com/@jimmyff-uk rel=me title=YouTube><i data-feather=youtube></i></a><li><a href=https://bsky.app/profile/faehound.games rel=me title=Bluesky><i data-feather=message-square></i></a><li><a href=https://www.instagram.com/jimmyff_art/jimmyff_art rel=me title=Medium><i data-feather=instagram></i></a><li><a href=https://medium.com/@jimmyff rel=me title=Medium><i data-feather=file-text></i></a><li><a href=https://www.jimmyff.co.uk/atom.xml title=jimmyff><i data-feather=rss></i></a></ul></div><p>¬© jimmyff 2025 <br>Powered by <a href=https://getzola.org/ target=_blank>Zola</a>. Theme: <a href=https://github.com/jimmyff/zola-inky target=_blank>Inky</a>.</footer><script>feather.replace()</script><script src="https://www.googletagmanager.com/gtag/js?id=G-71ZN1D4H6Q" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[];gtag(`js`,new Date());gtag(`config`,`G-71ZN1D4H6Q`)</script><script async src=/js/drop.js></script><script integrity="sha512-7x3zila4t2qNycrtZ31HO0NnJr8kg2VI67YLoRSyi9hGhRN66FHYWr7Axa9Y1J9tGYHVBPqIjSE1ogHrJTz51g==" async crossorigin src=https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.js></script>